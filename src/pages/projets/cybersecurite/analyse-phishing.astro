---
import BaseLayout from "../../../layouts/BaseLayout.astro";

const title = "Analyse de phishing — Investigation SOC";
const description = "Analyse d'emails suspects : décodage Base64, de pièce jointe et défanging d'URL pour investigation SOC.";
---

<BaseLayout title={title} description={description}>
  <main>
    <h1>Analyse de phishing — Investigation SOC</h1>

    <p class="intro">
      Projet réalisé dans le cadre d’une room TryHackMe orientée analyse de phishing.
      Objectif : reproduire une investigation SOC junior sur des emails suspects, sans exécuter
      de contenu potentiellement malveillant.
    </p>

    <h2>Contexte</h2>
    <p>
      Une machine virtuelle est fournie pour analyser plusieurs fichiers liés à une campagne de phishing
      (emails au format texte et <code>.eml</code>). L’analyse consiste à identifier les artefacts utiles,
      reconstruire une pièce jointe encodée et isoler les liens suspects.
    </p>

    <h2>Analyse de l’email et des artefacts</h2>
    <p>
      Lecture des emails et repérage des métadonnées MIME : présence d’une pièce jointe PDF annoncée
      comme encodée en <strong>Base64</strong>. L’objectif est de reconstruire le fichier pour l’inspecter
      dans un cadre contrôlé.
    </p>

    <h2>Reconstruction de la pièce jointe (Base64 → PDF)</h2>
    <p>
      Extraction du blob Base64 et décodage pour reconstituer le PDF. Décodage effectué via CyberChef
      (et vérifications locales) afin de confirmer le type de fichier.
    </p>

    <pre><code>
# Exemple de reconstruction (méthode)
base64 -d piece_jointe.b64 &gt; recovered.pdf
file recovered.pdf
    </code></pre>

    <h2>Analyse du contenu et des liens</h2>
    <p>
      Inspection du fichier <code>.eml</code> côté source (HTML) pour identifier les liens réellement utilisés
      derrière les éléments cliquables (boutons/CTA). Extraction de l’URL, puis identification du
      <strong>domaine</strong> associé.
    </p>

    <h2>Défanging pour reporting</h2>
    <p>
      Pour éviter tout clic accidentel et produire un rapport exploitable, le domaine est converti
      en format <em>defanged</em> (ex. remplacement de <code>http</code> → <code>hxxp</code> et <code>.</code> → <code>[.]</code>).
      Cette convention est standard en SOC/DFIR pour partager des IOC en sécurité.
    </p>

    <h2>Indicateurs de compromission (IOC)</h2>
    <ul>
      <li>Domaine suspect (defanged) : <code>t[.]teckbe[.]com</code></li>
      <li>Type d’attaque : phishing (usurpation de marque / incitation au clic)</li>
      <li>Vecteur : lien HTML dissimulé derrière un bouton</li>
    </ul>

    <h2>Compétences mobilisées</h2>
    <ul>
      <li>Analyse d’emails (MIME, pièces jointes, format <code>.eml</code>)</li>
      <li>Extraction et reconstruction d’artefacts (Base64)</li>
      <li>Analyse de liens et hygiène de navigation (defang)</li>
      <li>Raisonnement SOC : collecte d’IOC et rédaction synthétique</li>
    </ul>

    <h2>Objectif pédagogique</h2>
    <p>
      Comprendre comment un email de phishing peut embarquer des artefacts (pièces jointes encodées,
      liens masqués) et apprendre à les analyser en sécurité, avec une méthodologie reproductible.
    </p>

    <h2>Note éthique</h2>
    <p>
      Par respect pour TryHackMe, les réponses exactes attendues par l’exercice, les tokens uniques
      et certains détails permettant de reproduire la solution sans analyse sont volontairement omis.
      L’accent est mis sur la méthode et les bonnes pratiques de reporting.
    </p>
  </main>
</BaseLayout>
